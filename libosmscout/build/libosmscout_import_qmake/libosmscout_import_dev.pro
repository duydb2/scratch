TEMPLATE = lib
CONFIG -= qt
CONFIG += plugin # hack to avoid sonames
TARGET = osmscoutimport

# path that contains autogen'd files and fixes to
# build libosmscout with qmake
PATH_LIBOSMSCOUT_IMPORT_EXTRA = $${_PRO_FILE_PWD_}/libosmscout-import
PATH_LIBOSMSCOUT_IMPORT = /home/preet/Dev/projects/libosmscout-exp/libosmscout-import

# ======================================================= #
# autogen
# * environment specific files that automake generates
# ======================================================= #
INCLUDEPATH += $${PATH_LIBOSMSCOUT_IMPORT_EXTRA}/include

HEADERS += \
$${PATH_LIBOSMSCOUT_IMPORT_EXTRA}/include/osmscout/private/Config.h \
$${PATH_LIBOSMSCOUT_IMPORT_EXTRA}/include/osmscout/ImportFeatures.h


# ======================================================= #
# protocol buffer
# * pbf files automatically generated by the default
#   libosmscout-import build
# ======================================================= #
INCLUDEPATH += $${PATH_LIBOSMSCOUT_IMPORT_EXTRA}/include/osmscout/import/pbf

HEADERS += \
$${PATH_LIBOSMSCOUT_IMPORT_EXTRA}/include/osmscout/import/pbf/fileformat.pb.h \
$${PATH_LIBOSMSCOUT_IMPORT_EXTRA}/include/osmscout/import/pbf/osmformat.pb.h

SOURCES += \
$${PATH_LIBOSMSCOUT_IMPORT_EXTRA}/src/osmscout/import/pbf/fileformat.pb.cc \
$${PATH_LIBOSMSCOUT_IMPORT_EXTRA}/src/osmscout/import/pbf/osmformat.pb.cc


# ======================================================= #
# boost/unordered_set,unordered_map
# * for access to unordered_set and unordered_map even
#   if c++11 isn't supported on the target
# * including HashSet.h and HashMap.h before the versions
#   included in libosmscout will supercede them
# ======================================================= #
PATH_BOOST = /home/preet/Dev/env/sys/boost-1.55
DEFINES += USE_BOOST
INCLUDEPATH += $${PATH_BOOST}


# ======================================================= #
# import lib
# find include -name \*.h -printf %p' \\'\\n
# find src -name \*.cpp -printf %p' \\'\\n
# ======================================================= #
DEFINES += HAVE_LIB_PROTOBUF
DEFINES += HAVE_LIB_ZLIB

INCLUDEPATH += $${PATH_LIBOSMSCOUT_IMPORT}/include

HEADERS += \
$${PATH_LIBOSMSCOUT_IMPORT}/include/osmscout/private/ImportImportExport.h \
$${PATH_LIBOSMSCOUT_IMPORT}/include/osmscout/import/PreprocessOSM.h \
$${PATH_LIBOSMSCOUT_IMPORT}/include/osmscout/import/GenAreaAreaIndex.h \
$${PATH_LIBOSMSCOUT_IMPORT}/include/osmscout/import/RawCoastline.h \
$${PATH_LIBOSMSCOUT_IMPORT}/include/osmscout/import/Preprocess.h \
$${PATH_LIBOSMSCOUT_IMPORT}/include/osmscout/import/RawNode.h \
$${PATH_LIBOSMSCOUT_IMPORT}/include/osmscout/import/GenWayWayDat.h \
$${PATH_LIBOSMSCOUT_IMPORT}/include/osmscout/import/GenRouteDat.h \
$${PATH_LIBOSMSCOUT_IMPORT}/include/osmscout/import/GenLocationIndex.h \
$${PATH_LIBOSMSCOUT_IMPORT}/include/osmscout/import/GenWaterIndex.h \
$${PATH_LIBOSMSCOUT_IMPORT}/include/osmscout/import/GenWayAreaDat.h \
$${PATH_LIBOSMSCOUT_IMPORT}/include/osmscout/import/GenTypeDat.h \
$${PATH_LIBOSMSCOUT_IMPORT}/include/osmscout/import/Import.h \
$${PATH_LIBOSMSCOUT_IMPORT}/include/osmscout/import/RawWay.h \
$${PATH_LIBOSMSCOUT_IMPORT}/include/osmscout/import/GenOptimizeAreaWayIds.h \
$${PATH_LIBOSMSCOUT_IMPORT}/include/osmscout/import/GenTurnRestrictionDat.h \
$${PATH_LIBOSMSCOUT_IMPORT}/include/osmscout/import/GenNodeDat.h \
$${PATH_LIBOSMSCOUT_IMPORT}/include/osmscout/import/GenRelAreaDat.h \
$${PATH_LIBOSMSCOUT_IMPORT}/include/osmscout/import/GenAreaNodeIndex.h \
$${PATH_LIBOSMSCOUT_IMPORT}/include/osmscout/import/SortAreaDat.h \
$${PATH_LIBOSMSCOUT_IMPORT}/include/osmscout/import/SortWayDat.h \
$${PATH_LIBOSMSCOUT_IMPORT}/include/osmscout/import/SortDat.h \
$${PATH_LIBOSMSCOUT_IMPORT}/include/osmscout/import/PreprocessPBF.h \
$${PATH_LIBOSMSCOUT_IMPORT}/include/osmscout/import/GenOptimizeAreasLowZoom.h \
$${PATH_LIBOSMSCOUT_IMPORT}/include/osmscout/import/RawRelation.h \
$${PATH_LIBOSMSCOUT_IMPORT}/include/osmscout/import/GenNumericIndex.h \
$${PATH_LIBOSMSCOUT_IMPORT}/include/osmscout/import/SortNodeDat.h \
$${PATH_LIBOSMSCOUT_IMPORT}/include/osmscout/import/GenAreaWayIndex.h \
$${PATH_LIBOSMSCOUT_IMPORT}/include/osmscout/import/GenOptimizeWaysLowZoom.h

SOURCES += \
$${PATH_LIBOSMSCOUT_IMPORT}/src/osmscout/import/RawRelation.cpp \
$${PATH_LIBOSMSCOUT_IMPORT}/src/osmscout/import/SortWayDat.cpp \
$${PATH_LIBOSMSCOUT_IMPORT}/src/osmscout/import/SortDat.cpp \
$${PATH_LIBOSMSCOUT_IMPORT}/src/osmscout/import/Preprocess.cpp \
$${PATH_LIBOSMSCOUT_IMPORT}/src/osmscout/import/RawWay.cpp \
$${PATH_LIBOSMSCOUT_IMPORT}/src/osmscout/import/GenWayAreaDat.cpp \
$${PATH_LIBOSMSCOUT_IMPORT}/src/osmscout/import/SortAreaDat.cpp \
$${PATH_LIBOSMSCOUT_IMPORT}/src/osmscout/import/GenTypeDat.cpp \
$${PATH_LIBOSMSCOUT_IMPORT}/src/osmscout/import/GenTurnRestrictionDat.cpp \
$${PATH_LIBOSMSCOUT_IMPORT}/src/osmscout/import/GenOptimizeAreasLowZoom.cpp \
$${PATH_LIBOSMSCOUT_IMPORT}/src/osmscout/import/GenWaterIndex.cpp \
$${PATH_LIBOSMSCOUT_IMPORT}/src/osmscout/import/RawNode.cpp \
$${PATH_LIBOSMSCOUT_IMPORT}/src/osmscout/import/GenAreaAreaIndex.cpp \
$${PATH_LIBOSMSCOUT_IMPORT}/src/osmscout/import/Import.cpp \
$${PATH_LIBOSMSCOUT_IMPORT}/src/osmscout/import/GenNodeDat.cpp \
$${PATH_LIBOSMSCOUT_IMPORT}/src/osmscout/import/GenAreaWayIndex.cpp \
$${PATH_LIBOSMSCOUT_IMPORT}/src/osmscout/import/GenAreaNodeIndex.cpp \
$${PATH_LIBOSMSCOUT_IMPORT}/src/osmscout/import/GenLocationIndex.cpp \
$${PATH_LIBOSMSCOUT_IMPORT}/src/osmscout/import/GenWayWayDat.cpp \
$${PATH_LIBOSMSCOUT_IMPORT}/src/osmscout/import/GenOptimizeWaysLowZoom.cpp \
$${PATH_LIBOSMSCOUT_IMPORT}/src/osmscout/import/RawCoastline.cpp \
$${PATH_LIBOSMSCOUT_IMPORT}/src/osmscout/import/PreprocessPBF.cpp \
$${PATH_LIBOSMSCOUT_IMPORT}/src/osmscout/import/SortNodeDat.cpp \
$${PATH_LIBOSMSCOUT_IMPORT}/src/osmscout/import/GenRelAreaDat.cpp \
$${PATH_LIBOSMSCOUT_IMPORT}/src/osmscout/import/PreprocessOSM.cpp \
$${PATH_LIBOSMSCOUT_IMPORT}/src/osmscout/import/GenNumericIndex.cpp \
$${PATH_LIBOSMSCOUT_IMPORT}/src/osmscout/import/GenOptimizeAreaWayIds.cpp \
$${PATH_LIBOSMSCOUT_IMPORT}/src/osmscout/import/GenRouteDat.cpp

# libosmscout-import needs some additional libs...
INCLUDEPATH += /usr/include/libxml2
LIBS += -pthread
LIBS += -lprotobuf -lxml2 -lz
#LIBS += -lxml2 -lz -lm

# ...and core libosmscout as well
PATH_LIBOSMSCOUT=/home/preet/Dev/env/sys/libosmscout
INCLUDEPATH += $${PATH_LIBOSMSCOUT}/include
LIBS += -L$${PATH_LIBOSMSCOUT}/lib -losmscout


# ======================================================= #
# marisa
# ======================================================= #
#CONFIG+=use_marisa
use_marisa {
    DEFINES += OSMSCOUT_HAVE_LIB_MARISA
    DEFINES += OSMSCOUT_IMPORT_HAVE_LIB_MARISA
    PATH_MARISA=/home/preet/Dev/env/sys/marisa
    INCLUDEPATH += $${PATH_MARISA}/include
    LIBS += -L$${PATH_MARISA}/lib -lmarisa

    HEADERS += $${PATH_LIBOSMSCOUT_IMPORT}/include/osmscout/import/GenTextIndex.h
    SOURCES += $${PATH_LIBOSMSCOUT_IMPORT}/src/osmscout/import/GenTextIndex.cpp
}


# ======================================================= #
# install
# ======================================================= #
PATH_INSTALL = /home/preet/Dev/env/sys/libosmscout
target.path = $${PATH_INSTALL}/lib

header_files.files = $${PATH_LIBOSMSCOUT_IMPORT}/include/osmscout/*
header_files.path = $${PATH_INSTALL}/include/osmscout/

# note: even though include/private/Config.h gets copied over
#       its not used after building the lib and is harmless
more_header_files.files = $${PATH_LIBOSMSCOUT_IMPORT_EXTRA}/include/osmscout/*
more_header_files.path = $${PATH_INSTALL}/include/osmscout/

INSTALLS += target header_files more_header_files
